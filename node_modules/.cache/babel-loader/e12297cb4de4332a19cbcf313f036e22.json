{"ast":null,"code":"import _objectSpread from\"C:/Users/Lenovo/nutrition-assistant-webapp/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/Lenovo/nutrition-assistant-webapp/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Lenovo/nutrition-assistant-webapp/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Lenovo/nutrition-assistant-webapp/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Box}from'@mui/material';import{Container}from'@mui/system';import{useSnackbar}from'notistack';import React,{useContext,useState}from'react';import{useNavigate}from'react-router-dom';import{AppContext}from'../../Context/AppContext';import{API}from'../../services/apis';import{googleOauthPopup}from'../../services/firebase';import'../../styles/auth.modules.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Signin=function Signin(){var navigate=useNavigate();var _useSnackbar=useSnackbar(),enqueueSnackbar=_useSnackbar.enqueueSnackbar;var _useContext=useContext(AppContext),fetchTodaysConsumption=_useContext.fetchTodaysConsumption,setmaxCalories=_useContext.setmaxCalories,fetchWeekData=_useContext.fetchWeekData,setuserInfo=_useContext.setuserInfo;var _useState=useState({email:'',password:''}),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setstate=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setisLoading=_useState4[1];var handleSignIn=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(state.email.trim()===''||state.password.trim()==='')){_context.next=3;break;}enqueueSnackbar('Please fill all details',{variant:'error'});return _context.abrupt(\"return\");case 3:setisLoading(true);_context.prev=4;_context.next=7;return API.login({email:state.email,password:state.password});case 7:res=_context.sent;localStorage.setItem('token',res.token);localStorage.setItem('userInfo',JSON.stringify(res.user));if(res.user.IS_LOGIN_PROCESS_COMPLETE){setuserInfo(res.user);setmaxCalories(res.maxCalories);navigate('/dashboard');fetchTodaysConsumption();fetchWeekData();}else{navigate('/userInitialForm');}_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](4);enqueueSnackbar(_context.t0.response.data.msg,{variant:'error'});case 16:setisLoading(false);case 17:case\"end\":return _context.stop();}}},_callee,null,[[4,13]]);}));return function handleSignIn(){return _ref.apply(this,arguments);};}();var handleGoogleOauth=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var accessToken,res;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setisLoading(true);_context2.prev=1;_context2.next=4;return googleOauthPopup();case 4:accessToken=_context2.sent;_context2.next=7;return API.signInWithGoogle({accessToken:accessToken});case 7:res=_context2.sent;localStorage.setItem('token',res.token);localStorage.setItem('userInfo',JSON.stringify(res.user));if(res.user.IS_LOGIN_PROCESS_COMPLETE){setuserInfo(res.user);setmaxCalories(res.maxCalories);navigate('/dashboard');fetchTodaysConsumption();fetchWeekData();}else{navigate('/userInitialForm');}_context2.next=16;break;case 13:_context2.prev=13;_context2.t0=_context2[\"catch\"](1);enqueueSnackbar('Something went wrong',{variant:'error'});case 16:setisLoading(false);case 17:case\"end\":return _context2.stop();}}},_callee2,null,[[1,13]]);}));return function handleGoogleOauth(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{style:{background:'linear-gradient(45deg, rgba(244,235,215,1) 50%, rgba(241,181,113,1) 50%)',minHeight:'100vh'},children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"img\",{style:{width:'4rem',padding:'6px 0 0 6px'},src:\"/static/img/logo_crop.png\",alt:\"\"}),/*#__PURE__*/_jsx(Container,{maxWidth:\"sm\",style:{marginTop:'10px'},children:/*#__PURE__*/_jsxs(Box,{sx:{mx:'1rem',p:'1rem',backgroundColor:'#fff',borderRadius:'8px',boxShadow:'0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)'},children:[/*#__PURE__*/_jsx(\"h1\",{align:\"center\",children:\"Sign In\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'center',flexDirection:'column'},children:[/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{value:state.email,onChange:function onChange(e){return setstate(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{email:e.target.value});});},placeholder:\"myMail@mail.com\",className:\"textField\",type:\"email\"}),/*#__PURE__*/_jsx(\"label\",{placeholder:\"password\",className:\"label\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){return setstate(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{password:e.target.value});});},value:state.password,className:\"textField\",type:\"password\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center'},children:/*#__PURE__*/_jsx(\"button\",{disabled:isLoading,onClick:handleSignIn,style:{borderRadius:'6px',fontSize:'20px',padding:'12px 24px',background:'var(--themecolor)',border:'1px solid var(--themecolor)',color:'#fff',marginTop:'20px'},className:\"btn\",type:\"submit\",children:\"Sign In\"})}),/*#__PURE__*/_jsxs(\"button\",{disabled:isLoading,style:{color:'var(--themecolor)',marginTop:'20px',background:'#fff',border:'1px solid #fff'},onClick:function onClick(e){navigate('/signup');},children:[\"Dont have an account? sign up\",' ']})]}),/*#__PURE__*/_jsx(\"hr\",{style:{marginTop:'15px'}}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center'},children:/*#__PURE__*/_jsxs(\"button\",{disabled:isLoading,onClick:handleGoogleOauth,style:{display:'flex',justifyContent:'center',alignItems:'center',fontSize:'20px',padding:'10px 18px',border:'0px solid black',borderRadius:'5px',margin:'10px 0',background:'#fff',boxShadow:'0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)'},children:[/*#__PURE__*/_jsx(\"img\",{style:{width:'24px',margin:'3px 10px 0 0'},src:\"/static/img/google_icon.png\",alt:\"google icon\"}),/*#__PURE__*/_jsx(\"span\",{children:\" Login with Google\"})]})})]})})]})});};export default Signin;","map":null,"metadata":{},"sourceType":"module"}